# REST API 简介

## API 版本

最新稳定版本是 2.0

## API 域名

REST 请求访问域名为:

`https://api.maxleap.cn`

域名后需要增加版本号，当前最新版本为 2.0，完整的请求路径示例：

`https://api.maxleap.cn/2.0/classes/books`

## API 请求

### 请求格式

对于 POST 和 PUT 请求，请求的主体必须是 JSON 格式，而且 HTTP header 的 Content-Type 需要设置为 application/json。

用户验证通过 HTTP header 来进行，X-ML-AppId 标明正在运行的是哪个应用，X-ML-APIKey 用来授权鉴定

```shell
    curl -X POST \
      -H "X-ML-AppId: 569d84a0169e7d00012c7afe" \
      -H "X-ML-APIKey: MjVvSjJUMTZveUR2d1hoNlVoQ0R1QQ" \
      -H "Content-Type: application/json" \
      -d '{"content": "这是一条测试"}' \
      https://api.maxleap.cn/2.0/classes/test
```

### 响应格式

对于所有的请求，响应格式都是一个 JSON 对象。

一个请求是否成功是由 HTTP 状态码标明的。一个 2XX 的状态码表示成功，而一个 4XX 表示请求失败。当一个请求失败时响应的主体仍然是一个 JSON 对象，但是总是会包含 code 和 error 这两个字段，你可以用它们来进行调试。举个例子，如果尝试用非法的属性名来保存一个对象会得到如下信息：

```json
    {
      "code": 105,
      "error": "invalid field name: bl!ng"
    }
```
## 通用错误码

| 错误码 | 含义 | 备注 |
|----|----|----|
| 1 | 服务器内部问题 | |
| 2 | 第三方接口错误 | |
| 100 | 连接失败 | |
| 101 | 未找到请求资源 | |
| 102 | 查询语法错误 | |
| 103 | 缺少或者无效的类名 | |
| 104 | 缺少或者无效的ObjectId | |
| 105 | 无效的键名 | |
| 106 | 无效的类型 | |
| 107 | 无效的json | |
| 108 | 命令不可用 | |
| 109 | 未初始化 | |
| 110 | 更新语法错误 | |
| 111 | 类型不匹配 | |
| 112 | 无效的频道名 | |
| 113 | 未找到绑定的类 | |
| 115 | 推送配置错误 | |
| 116 | 数据太大 | |
| 118 | 无效的ObjectId | |
| 119 | 操作受限 | |
| 120 | 未找到缓存 | |
| 121 | 无效的嵌套键 | |
| 122 | 无效的文件名 | |
| 123 | 无效的ACL | |
| 124 | 超时 | |
| 125 | 无效的邮件地址 | |
| 136 | 禁止修改角色名称 | |
| 137 | 值重复 | |
| 139 | 无效的角色名称 | |
| 140 | 超过指标 | |
| 141 | 云代码错误 | |
| 142 | 角色未找到 | |
| 143 | 云代码未发布 | |
| 160 | 无效的会话标记 | |
| 200 | 缺少用户名 | |
| 201 | 缺少用户密码 | |
| 202 | 此用户名已被占用 | |
| 203 | 此邮箱已被占用 | |
| 204 | 缺少邮箱 | |
| 205 | 未找到邮箱 | |
| 206 | 缺少会话信息 | |
| 207 | 必须通过注册创建用户 | |
| 208 | 此账户已被关联 | |
| 210 | 用户密码不匹配 | |
| 211 | 未找到此用户 | |
| 212 | 此名称已被占用 | |
| 213 | 此id已被占用 | |
| 214 | 缺少一些字段 | |
| 215 | 邮箱未验证 | |
| 216 | 无效的发票 | |
| 217 | 数量已满 | |
| 220 | 设备类型错误 | |
| 221 | 任务状态错误 | |
| 222 | 任务格式化错误 | |
| 225 | 推送系统错误 | |
| 226 | 推送结束 | |
| 239 | 缺少短信验证码 | |
| 240 | 手机号码已经被注册 | |
| 241 | 验证码有误 | |
| 242 | 数量已满 | |
| 243 | 短信参数无效 | |
| 250 | 缺少关联的id | |
| 251 | 无效的关联会话信息 | |
| 252 | 此服务不支持 | |
| 253 | 无效的authData | |
| 254 | 手机号码未验证 | |
| 301 | 验证码错误 | |
| 401 | 未授权 | |
| 503 | 访问频率受限 | |
| 601 | 无效的请求 | |
| 602 | 远程的账单服务错误 | |
| 603 | 绑定卡错误 | |
| 604 | 账单权限错误 | |
| 109999 | 系统错误 | 云代码 |
| 109998 | 云代码异常 | 云代码 |
| 109997 | 访问云代码失败 | 云代码 |
| 100000 | 至少选择一个实例来部署 | 云代码 |
| 100001 | 你的云代码正在操作中，请稍后重试 | 云代码 |
| 100002 | 资源名称重复 | 云代码 |
| 100003 | 当前宿主机有实例正在运行 | 云代码 |
| 100004 | 无效的资源ID | 云代码 |
| 100005 | 无效的宿主机IP | 云代码 |
| 100006 | 无效的容器ID | 云代码 |
| 100007 | 当前版本有实例正在运行，删除版本前请先停用它们 | 云代码 |
| 100008 | 至少选择一个实例来缩容 | 云代码 |
| 100009 | 当前版本还没有部署任何实例，扩容版本前请先部署 | 云代码 |
| 100010 | 当前版本已经部署 | 云代码 |
| 100011 | 无效的宿主机ID | 云代码 |
| 100012 | 没有足够的内存资源 | 云代码 |
| 100013 | 无效的MAC地址 | 云代码 |
| 100014 | 没有足够的端口资源 | 云代码 |
| 100015 | 应用ID和MASTER_KEY不匹配 | 云代码 |
| 100016 | 缺少配置，你必须为你的应用指定applicationId（应用ID） | 云代码 |
| 100017 | 检查云代码失败，当前上传的代码不匹配当前应用，请检查你的云代码配置applicationId（应用ID） | 云代码 |
| 100018 | 缺少配置，你必须为你的应用指定applicationKey（Master Key） | 云代码 |
| 100019 | 缺少配置，你必须为你的应用指定applicationName（应用名称） | 云代码 |
| 100020 | 缺少配置，你必须为你的应用指定version（版本） | 云代码 |
| 100021 | 缺少配置，你必须为你的应用指定lang（语言） | 云代码 |
| 100022 | 无效的配置项lang（语言），不支持该语言 | 云代码 |
| 100023 | 缺少配置，你必须为你的应用指定javaMain（程序入口） | 云代码 |
| 100024 | 当前版本还没有部署任何实例 | 云代码 |
| 100025 | 你必须指定版本请求比例 | 云代码 |
| 100026 | 版本请求比例无效，最多指定2个版本请求比例 | 云代码 |
| 100027 | 版本请求比例无效，比例总和必须为10 | 云代码 |
| 100028 | 版本号无效，该版本还没有运行 | 云代码 |
| 100029 | 解析配置失败，配置必须是符合JSON格式 | 云代码 |
| 100030 | 访问CloudCode实例服务失败，服务不可用 | 云代码 |
| 100031 | 获取CloudCode应用镜像失败 | 云代码 |
| 100032 | 构建CloudCode应用镜像失败 | 云代码 |
| 100033 | 上传CloudCode应用镜像失败 | 云代码 |
| 100034 | 创建CloudCode应用实例容器失败 | 云代码 |
| 100035 | 启动CloudCode应用实例容器失败 | 云代码 |
| 100036 | 检测到CloudCode应用实例容器处于非运行状态 | 云代码 |
| 100037 | 未检测到CloudCode应用实例容器状态 | 云代码 |
| 100038 | 上传云代码文件不能为空 | 云代码 |
| 100039 | 当前账号级别无法使用该功能，请提升账号等级 | 云代码 |
| 100040 | 容器ID不能为空 | 云代码 |
| 100401 | 无效的任务ID | 云代码 |
| 90000 | 没有权限 | |
| 90100 | 无效的会话标识 | |
| 90101 | 过期的会话标识 | |
| 90102 | 应用id和key不匹配 | |
| 90103 | 应用id和会话标识不匹配 | |





